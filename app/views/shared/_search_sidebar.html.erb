<%= search_form_for @q, url: bars_path, method: :get, local: true, html: { id: 'unified-search-form' } do |f| %>
  <div class="mb-8">
    <%= f.text_field :name_cont,
        placeholder: "ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§ãƒãƒ¼ã‚’æ¤œç´¢",
        class: "search-input",
        value: params.dig(:q, :name_cont) %>
  </div>
  <div class="mb-6">
    <div class="sidebar-section-title">ã‚¨ãƒªã‚¢</div>
    <div class="mb-3">
      <%= f.text_field :address_cont,
          placeholder: "ã‚¨ãƒªã‚¢ã‚’å…¥åŠ›...",
          class: "search-input",
          value: params.dig(:q, :address_cont) %>
    </div>
    <div class="filter-options-container">
      <% %w[æ–°å®¿ å…­æœ¬æœ¨ æµæ¯”å¯¿ æ¸‹è°·].each do |area| %>
        <div class="filter-option <%= 'active' if params.dig(:q, :address_cont) == area %>"
             onclick="setFilterValue('address_cont', '<%= area %>')">
          <span class="filter-option-label"><%= area %></span>
          <span class="filter-option-count"><%= Bar.where('address ILIKE ?', "%#{area}%").count %></span>
        </div>
      <% end %>
      <% if params.dig(:q, :address_cont).present? %>
        <div class="filter-option" onclick="clearFilterValue('address_cont')">
          <span class="text-lg">ğŸ”„</span>
          <span class="filter-option-label">ã™ã¹ã¦è¡¨ç¤º</span>
        </div>
      <% end %>
    </div>
  </div>
  <!-- ä¾¡æ ¼å¸¯ã€å¾Œã§å®Ÿè£… -->
  <div class="mb-6">
    <div class="sidebar-section-title">ä¾¡æ ¼å¸¯</div>
    <div class="filter-options-container">
      <% [
        { value: 'ãƒªãƒ¼ã‚ºãƒŠãƒ–ãƒ«', label: 'ãƒªãƒ¼ã‚ºãƒŠãƒ–ãƒ«' },
        { value: 'æ¨™æº–', label: 'æ¨™æº–' },
        { value: 'é«˜ç´š', label: 'é«˜ç´š' }
      ].each do |option| %>
        <div class="filter-option <%= 'active' if params.dig(:q, :price_range_eq) == option[:value] %>"
             onclick="setFilterValue('price_range_eq', '<%= option[:value] %>')">
          <span class="text-lg"><%= option[:emoji] %></span>
          <span class="filter-option-label"><%= option[:label] %></span>
          <span class="filter-option-count"><%= Bar.where(price_range: option[:value]).count %></span>
        </div>
      <% end %>
      <% if params.dig(:q, :price_range_eq).present? %>
        <div class="filter-option" onclick="clearFilterValue('price_range_eq')">
          <span class="text-lg">ğŸ”„</span>
          <span class="filter-option-label">ã™ã¹ã¦è¡¨ç¤º</span>
        </div>
      <% end %>
    </div>
    <%= f.hidden_field :price_range_eq, value: params.dig(:q, :price_range_eq) %>
  </div>
  <div class="mb-6">
    <div class="sidebar-section-title">å–«ç…™çŠ¶æ³</div>
    <div class="filter-options-container">
      <% [
        { value: 'ç¦ç…™', emoji: 'ğŸš­', label: 'ç¦ç…™' },
        { value: 'å–«ç…™å¯', emoji: 'ğŸš¬', label: 'å–«ç…™å¯' }
      ].each do |option| %>
        <div class="filter-option <%= 'active' if params.dig(:q, :smoking_status_eq) == option[:value] %>"
             onclick="setFilterValue('smoking_status_eq', '<%= option[:value] %>')">
          <span class="text-lg"><%= option[:emoji] %></span>
          <span class="filter-option-label"><%= option[:label] %></span>
          <span class="filter-option-count"><%= Bar.where(smoking_status: option[:value]).count %></span>
        </div>
      <% end %>
      <% if params.dig(:q, :smoking_status_eq).present? %>
        <div class="filter-option" onclick="clearFilterValue('smoking_status_eq')">
          <span class="text-lg">ğŸ”„</span>
          <span class="filter-option-label">ã™ã¹ã¦è¡¨ç¤º</span>
        </div>
      <% end %>
    </div>
    <%= f.hidden_field :smoking_status_eq, value: params.dig(:q, :smoking_status_eq) %>
  </div>
  <!-- å…¨æ¡ä»¶ã‚¯ãƒªã‚¢ã€å¾Œã§å®Ÿè£… -->
  <% if search_performed? %>
    <div class="mb-6">
      <div class="filter-option" onclick="clearAllFiltersUnified()" style="justify-content: center; background-color: var(--wine); color: white;">
        <span class="text-lg">ğŸ”„</span>
        <span class="filter-option-label">ã™ã¹ã¦ã®æ¡ä»¶ã‚’ã‚¯ãƒªã‚¢</span>
      </div>
    </div>
  <% end %>
<% end %>
